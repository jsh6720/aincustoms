<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>아인합동관세사무소 - 전문 관세 서비스</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        .hero-section {
            background: linear-gradient(rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url('./images/hero-background.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            border-bottom: 1px solid rgba(0,0,0,0.08);
        }
        
        .logo img {
            height: 50px;
            width: auto;
            object-fit: contain;
        }
        
        .scroll-offset {
            scroll-margin-top: 100px;
        }
        
        .fade-in {
            opacity: 0;
            transform: translateY(24px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .team-member img {
            width: 200px;
            height: 300px;
            object-fit: cover;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.12);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .team-member img:hover {
            transform: translateY(-8px);
            box-shadow: 0 32px 64px rgba(0,0,0,0.16);
        }
        
        .analysis-example img {
            width: 100%;
            max-width: 600px;
            height: auto;
            object-fit: contain;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .service-card {
            background: white;
            border-radius: 20px;
            padding: 32px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.06);
            border: 1px solid rgba(0,0,0,0.04);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            height: 100%;
        }
        
        .service-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 48px rgba(0,0,0,0.12);
        }
        
        .specialty-item {
            background: white;
            border-radius: 20px;
            padding: 32px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.06);
            border: 1px solid rgba(0,0,0,0.04);
            margin-bottom: 24px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .specialty-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 16px 40px rgba(0,0,0,0.1);
        }
        
        .hero-text {
            text-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            padding: 16px 32px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 18px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: none;
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(59, 130, 246, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(59, 130, 246, 0.4);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }
        
        .perfect-grid {
            display: grid;
            gap: 24px;
            align-items: stretch;
        }
        
        .grid-4 { grid-template-columns: repeat(4, 1fr); }
        .grid-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-2 { grid-template-columns: repeat(2, 1fr); }
        
        /* 모달 스타일 */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .login-modal-content {
            background: white;
            border-radius: 16px;
            width: 400px;
            max-width: 90vw;
            padding: 32px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .duty-modal-content {
            background: white;
            border-radius: 16px;
            width: 90%;
            max-width: 1200px;
            min-height: 600px;
            max-height: 90vh;
            padding: 32px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow-y: auto;
        }
        
        .close-button {
            position: absolute;
            top: 16px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            z-index: 1000;
        }
        
        .close-button:hover {
            color: #333;
        }
        
        /* 테이블 스타일 */
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .results-table th {
            background-color: #f8fafc;
            padding: 12px;
            text-align: left;
            border-bottom: 2px solid #e2e8f0;
            font-weight: 600;
            color: #374151;
            position: sticky;
            top: 0;
        }
        
        .results-table td {
            padding: 12px;
            border-bottom: 1px solid #e2e8f0;
            color: #374151;
        }
        
        .results-table tbody tr:nth-child(even) {
            background-color: #f9fafb;
        }
        
        .results-table tbody tr:hover {
            background-color: #f3f4f6;
        }
        
        .copyable-cell {
            cursor: pointer;
            color: #3b82f6;
            font-weight: 500;
            transition: color 0.2s;
        }
        
        .copyable-cell:hover {
            color: #1d4ed8;
            background-color: #dbeafe;
        }
        
        /* 탭 스타일 */
        .tab-container {
            margin-bottom: 24px;
        }
        
        .tab-buttons {
            display: flex;
            border-bottom: 2px solid #e5e7eb;
            margin-bottom: 20px;
        }
        
        .tab-button {
            padding: 12px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: #6b7280;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
        }
        
        .tab-button.active {
            color: #3b82f6;
            border-bottom-color: #3b82f6;
        }
        
        .tab-button:hover {
            color: #374151;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* 편집 버튼 스타일 */
        .edit-button, .save-button, .cancel-button, .delete-button {
            padding: 6px 12px;
            margin: 0 2px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
            font-weight: 500;
        }
        
        .edit-button {
            background-color: #fbbf24;
            color: white;
        }
        
        .edit-button:hover {
            background-color: #f59e0b;
        }
        
        .save-button {
            background-color: #10b981;
            color: white;
        }
        
        .save-button:hover {
            background-color: #059669;
        }
        
        .cancel-button {
            background-color: #6b7280;
            color: white;
        }
        
        .cancel-button:hover {
            background-color: #4b5563;
        }
        
        .delete-button {
            background-color: #ef4444;
            color: white;
        }
        
        .delete-button:hover {
            background-color: #dc2626;
        }
        
        /* 편집 중인 셀 스타일 */
        .editing-cell {
            padding: 4px !important;
        }
        
        .editing-input {
            width: 100%;
            padding: 8px;
            border: 2px solid #3b82f6;
            border-radius: 4px;
            font-size: 14px;
            background-color: #f8faff;
            outline: none;
        }
        
        .editing-input:focus {
            border-color: #1d4ed8;
            background-color: white;
        }
        
        /* 자동완성 스타일 */
        .autocomplete-container {
            position: relative;
        }
        
        .autocomplete-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #e5e7eb;
            border-top: none;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        
        .autocomplete-item {
            padding: 8px 12px;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
            font-size: 14px;
            color: #374151;
        }
        
        .autocomplete-item:hover,
        .autocomplete-item.selected {
            background-color: #f3f4f6;
        }
        
        .autocomplete-item:last-child {
            border-bottom: none;
        }
        
        .highlight {
            font-weight: bold;
            color: #3b82f6;
        }
        
        /* 토스트 메시지 */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #10b981;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 3000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s;
        }
        
        .toast.show {
            opacity: 1;
            transform: translateX(0);
        }
        
        .toast.error {
            background-color: #ef4444;
        }
        
        /* 로딩 상태 */
        .loading {
            opacity: 0.5;
            pointer-events: none;
        }
        
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* 반응형 디자인 */
        @media (max-width: 1024px) {
            .grid-4 { grid-template-columns: repeat(2, 1fr); }
            .grid-3 { grid-template-columns: repeat(2, 1fr); }
        }
        
        @media (max-width: 768px) {
            .logo img {
                height: 40px;
            }
            .team-member img {
                width: 160px;
                height: 240px;
            }
            .hero-section {
                background-attachment: scroll;
                padding: 40px 20px;
            }
            .container {
                padding: 0 16px;
            }
            .scroll-offset {
                scroll-margin-top: 80px;
            }
            .grid-4 { grid-template-columns: repeat(2, 1fr); }
            .grid-3 { grid-template-columns: 1fr; }
            .grid-2 { grid-template-columns: 1fr; }
            .login-modal-content {
                width: 95%;
                padding: 24px;
            }
            .duty-modal-content {
                width: 95%;
                padding: 20px;
            }
        }
        
        @media (max-width: 640px) {
            .results-table {
                font-size: 14px;
            }
            
            .results-table th,
            .results-table td {
                padding: 8px 4px;
            }
            
            .tab-button {
                padding: 8px 12px;
                font-size: 14px;
            }
            
            .edit-button, .save-button, .cancel-button, .delete-button {
                padding: 4px 8px;
                font-size: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- 네비게이션 -->
    <nav class="navbar">
        <div class="container flex justify-between items-center py-12">
            <!-- 로고 -->
            <div class="logo">
                <img src="./images/logo.png" alt="아인합동관세사무소 로고">
            </div>
            
            <!-- 메뉴 -->
            <div class="hidden md:flex space-x-8">
                <a href="#home" class="text-gray-700 hover:text-blue-600 font-medium text-lg transition-colors">홈</a>
                <a href="#about" class="text-gray-700 hover:text-blue-600 font-medium text-lg transition-colors">회사소개</a>
                <a href="#services" class="text-gray-700 hover:text-blue-600 font-medium text-lg transition-colors">전문서비스</a>
                <a href="#team" class="text-gray-700 hover:text-blue-600 font-medium text-lg transition-colors">구성원소개</a>
                <a href="#specialty" class="text-gray-700 hover:text-blue-600 font-medium text-lg transition-colors">AI 통관</a>
                <a href="#contact" class="text-gray-700 hover:text-blue-600 font-medium text-lg transition-colors">연락처</a>
                <a href="#" onclick="showDutyLogin()" class="text-red-600 hover:text-red-800 font-bold text-lg transition-colors">관세성실신고 조회</a>
            </div>
        </div>
    </nav>

    <!-- 히어로 섹션 -->
    <section id="home" class="hero-section">
        <div class="text-center text-white hero-text">
            <h1 class="text-5xl md:text-6xl font-bold mb-6 leading-tight">아인합동관세사무소</h1>
            <p class="text-xl md:text-2xl mb-4 font-medium">Maximized Efficiency, Minimized Risk</p>
            <p class="text-lg md:text-xl mb-8 leading-relaxed max-w-4xl mx-auto">4대 회계법인 출신 관세사들의 신속한 통관 서비스와<br>국내 최고 수준의 AI Compliance, Risk 관리를 함께</p>
            <button onclick="document.getElementById('contact').scrollIntoView({behavior: 'smooth', block: 'start'})" class="btn-primary">
                상담 및 문의
            </button>
        </div>
    </section>

    <!-- 회사 소개 -->
    <section id="about" class="scroll-offset py-20 bg-gray-50">
        <div class="container">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-800 mb-6">회사 소개</h2>
                <p class="text-xl text-gray-600 max-w-4xl mx-auto leading-relaxed">
                    아인합동관세사무소는 통관 서비스뿐만 아니라, 수출입과 관련된 요건, 외국환 등 관세 무역과 관련한 Risk 관리에 최적화된 통합 솔루션을 제공하는 전문가입니다.
                </p>
            </div>
            
            <div class="perfect-grid grid-3">
                <div class="text-center fade-in">
                    <div class="bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-shield-alt text-blue-600 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">전문성</h3>
                    <p class="text-gray-600 leading-relaxed">4대 회계법인 출신 관세사들의 전문적인 서비스</p>
                </div>
                
                <div class="text-center fade-in">
                    <div class="bg-green-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-chart-line text-green-600 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">효율성</h3>
                    <p class="text-gray-600 leading-relaxed">AI 기술을 활용한 스마트 관세 솔루션</p>
                </div>
                
                <div class="text-center fade-in">
                    <div class="bg-red-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-handshake text-red-600 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">신뢰성</h3>
                    <p class="text-gray-600 leading-relaxed">고객의 리스크를 최소화하는 통합 관리</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 전문 서비스 -->
    <section id="services" class="scroll-offset py-20 bg-white">
        <div class="container">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-800 mb-6">전문 서비스</h2>
                <p class="text-xl text-gray-600">관세 전 분야에 걸친 종합적인 전문 서비스를 제공합니다</p>
            </div>
            
            <div class="perfect-grid grid-3">
                <div class="service-card fade-in">
                    <div class="text-blue-600 text-3xl mb-6">
                        <i class="fas fa-ship"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">수출입 통관</h3>
                    <p class="text-gray-600 leading-relaxed">FTA 활용, 세관장확인대상, 개별법령 요건 검토를 통한 신속하고 정확한 통관 서비스</p>
                </div>
                
                <div class="service-card fade-in">
                    <div class="text-green-600 text-3xl mb-6">
                        <i class="fas fa-tags"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">품목분류 및 경정청구</h3>
                    <p class="text-gray-600 leading-relaxed">고도의 전문성이 요구되는 품목분류 분야의 최상의 결과 제공</p>
                </div>
                
                <div class="service-card fade-in">
                    <div class="text-purple-600 text-3xl mb-6">
                        <i class="fas fa-certificate"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">AEO 대리</h3>
                    <p class="text-gray-600 leading-relaxed">인증 및 종합심사 전문 대리 서비스</p>
                </div>
                
                <div class="service-card fade-in">
                    <div class="text-red-600 text-3xl mb-6">
                        <i class="fas fa-search"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">관세심사 및 조사대리</h3>
                    <p class="text-gray-600 leading-relaxed">실지심사 전문 대응 및 포괄적인 심사 지원 서비스</p>
                </div>
                
                <div class="service-card fade-in">
                    <div class="text-yellow-600 text-3xl mb-6">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">외환진단 및 검사대응</h3>
                    <p class="text-gray-600 leading-relaxed">외국환거래 분야의 전문적인 진단 및 조사 대응</p>
                </div>
                
                <div class="service-card fade-in">
                    <div class="text-indigo-600 text-3xl mb-6">
                        <i class="fas fa-gavel"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">관세, 외국환 통상 자문</h3>
                    <p class="text-gray-600 leading-relaxed">관세 및 무역 관련 다양한 분야의 상시 자문 서비스</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 구성원 소개 -->
    <section id="team" class="scroll-offset py-20 bg-gray-50">
        <div class="container">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-800 mb-6">구성원 소개</h2>
                <p class="text-xl text-gray-600">4대 회계법인 출신 관세사들의 전문적인 서비스</p>
            </div>
            
            <div class="perfect-grid grid-4">
                <!-- 조재호 관세사 -->
                <div class="team-member text-center fade-in">
                    <img src="./images/cho-jaeho.jpg" alt="조재호 관세사" class="mx-auto mb-4">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">조재호 관세사</h3>
                    <p class="text-blue-600 font-semibold text-sm mb-2">4대 회계법인 출신</p>
                    <p class="text-gray-600 text-sm">수출입통관, 관세심사, 외국환, 이전가격</p>
                </div>
                
                <!-- 정석현 관세사 -->
                <div class="team-member text-center fade-in">
                    <img src="./images/jung-seokhyeon.jpg" alt="정석현 관세사" class="mx-auto mb-4">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">정석현 관세사</h3>
                    <p class="text-blue-600 font-semibold text-sm mb-2">4대 회계법인 출신</p>
                    <p class="text-gray-600 text-sm">수출입요건, 외국환, 관세심사, 품목분류</p>
                </div>
                
                <!-- 박종욱 관세사 -->
                <div class="team-member text-center fade-in">
                    <img src="./images/park-jongwook.jpg" alt="박종욱 관세사" class="mx-auto mb-4">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">박종욱 관세사</h3>
                    <p class="text-blue-600 font-semibold text-sm mb-2">4대 관세법인 출신</p>
                    <p class="text-gray-600 text-sm">수출입통관, 품목분류, 외국환거래, FTA</p>
                </div>
                
                <!-- 김로언 관세사 -->
                <div class="team-member text-center fade-in">
                    <img src="./images/kim-roeun.jpg" alt="김로언 관세사" class="mx-auto mb-4">
                    <h3 class="text-lg font-bold text-gray-800 mb-2">김로언 관세사</h3>
                    <p class="text-blue-600 font-semibold text-sm mb-2">관세 전문가</p>
                    <p class="text-gray-600 text-sm">수출입통관, 수출입요건, 품목분류, 관세감면</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Ain's Specialty -->
    <section id="specialty" class="scroll-offset py-20 bg-white">
        <div class="container">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-800 mb-6">Ain's Specialty</h2>
                <p class="text-xl text-gray-600">아인만의 차별화된 전문 서비스</p>
            </div>
            
            <!-- AI and Customs -->
            <div class="specialty-item fade-in">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">
                    <i class="fas fa-robot text-blue-600 mr-3"></i>AI and Customs
                </h3>
                
                <!-- 분석 자료 예시 이미지 -->
                <div class="analysis-example text-center mb-8">
                    <img src="./images/analysis-data.png" alt="수출입 통관 데이터 분석 예시" class="mx-auto mb-4">
                </div>
                
                <div class="perfect-grid grid-2">
                    <div>
                        <h4 class="text-xl font-semibold text-gray-800 mb-4">빅데이터 분석</h4>
                        <ul class="text-gray-600 space-y-2">
                            <li>• 수출입 통관 패턴 및 트렌드 분석</li>
                            <li>• 과거 데이터 기반 최적화 방안 제시</li>
                            <li>• 업종별, 품목별 맞춤 분석</li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 class="text-xl font-semibold text-gray-800 mb-4">AI 기반 위험 분석</h4>
                        <ul class="text-gray-600 space-y-2">
                            <li>• 사전 예방적 리스크 예측 모델</li>
                            <li>• 실시간 법령 변경사항 모니터링</li>
                            <li>• 맞춤형 컴플라이언스 솔루션</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- 기타 전문 서비스들 -->
            <div class="perfect-grid grid-2">
                <div class="specialty-item fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-cog text-green-600 mr-3"></i>Compliance 특화 서비스
                    </h3>
                    <p class="text-gray-600 mb-4">품목분류 관리를 통한 세율, 요건 관리의 기초 구축</p>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 인보이스상 기재사항 2차 검토</li>
                        <li>• AI 기반 품목분류 검증</li>
                        <li>• Risk Check by Database</li>
                    </ul>
                </div>
                
                <div class="specialty-item fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-balance-scale text-blue-600 mr-3"></i>수출입요건 전문 관세사
                    </h3>
                    <p class="text-gray-600 mb-4">69개 개별 법령에 대한 전문적 검토</p>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 의료기기법, 약사법 전문 대응</li>
                        <li>• 화학물질관리법 요건 검토</li>
                        <li>• 전파법 적용대상 사전 점검</li>
                    </ul>
                </div>
                
                <div class="specialty-item fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-dollar-sign text-purple-600 mr-3"></i>외국환거래법 전문 관세사
                    </h3>
                    <p class="text-gray-600 mb-4">경상거래, 자본거래 관련 신고 절차 이행 자문</p>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 상계, 3자지급, 기간초과지급 검토</li>
                        <li>• 사후보고 가능성 판단</li>
                        <li>• 위반건 소명논리 개발</li>
                    </ul>
                </div>
                
                <div class="specialty-item fade-in">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">
                        <i class="fas fa-chart-bar text-red-600 mr-3"></i>지속적인 Risk 분석 제공
                    </h3>
                    <p class="text-gray-600 mb-4">반기별 수출입 통관 현황 및 위험 요소 분석</p>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 누적 데이터 기반 분석</li>
                        <li>• 대용량 분석 지원</li>
                        <li>• 맞춤형 리포트 제공</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- 연락처 -->
    <section id="contact" class="scroll-offset py-20 bg-gray-50">
        <div class="container">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-800 mb-6">연락처</h2>
                <p class="text-xl text-gray-600">전문적인 관세 서비스가 필요하시면 언제든 연락주세요</p>
            </div>
            
            <div class="perfect-grid grid-3">
                <div class="text-center fade-in">
                    <div class="bg-blue-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-map-marker-alt text-blue-600 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">주소</h3>
                    <p class="text-gray-600 leading-relaxed">서울본사: 서울특별시 강남구 학동로 43길 38, 145호</p>
                    <p class="text-gray-600 leading-relaxed">인천지사: 인천시 부평구 부평대로 337, 325호</p>
                </div>
                
                <div class="text-center fade-in">
                    <div class="bg-green-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-phone text-green-600 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">전화 / 팩스</h3>
                    <p class="text-gray-600 leading-relaxed">전화: 02-518-5434, 032-265-2750<br>팩스: 02-518-5436</p>
                </div>
                
                <div class="text-center fade-in">
                    <div class="bg-red-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6">
                        <i class="fas fa-envelope text-red-600 text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold mb-4">이메일</h3>
                    <p class="text-gray-600 text-sm leading-relaxed">
                        정석현 대표관세사: jsh@aincustoms.com<br>
                        조재호 대표관세사: jhcho@aincustoms.com<br>
                        박종욱 대표관세사: jwpark@aincustoms.com
                    </p>
                </div>
            </div>
            
            <div class="text-center mt-16 fade-in">
                <div class="bg-white inline-block px-8 py-8 rounded-2xl shadow-lg max-w-2xl">
                    <h3 class="text-2xl font-bold text-gray-800 mb-4">전문 상담 신청</h3>
                    <p class="text-gray-600 mb-6">4대 회계법인 출신 관세사가 직접 상담해드립니다</p>
                    <div class="flex flex-wrap justify-center gap-3">
                        <span class="bg-blue-100 text-blue-800 px-4 py-2 rounded-full text-sm font-semibold">관세심사 대응</span>
                        <span class="bg-green-100 text-green-800 px-4 py-2 rounded-full text-sm font-semibold">수출입통관</span>
                        <span class="bg-purple-100 text-purple-800 px-4 py-2 rounded-full text-sm font-semibold">AI 통관 솔루션</span>
                        <span class="bg-red-100 text-red-800 px-4 py-2 rounded-full text-sm font-semibold">외환 진단</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 로그인 모달 -->
    <div id="loginModal" class="modal">
        <div class="login-modal-content">
            <button class="close-button" onclick="closeModal('loginModal')">&times;</button>
            <h2 class="text-2xl font-bold text-center mb-6 text-gray-800">관세성실신고 조회</h2>
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="mb-4">
                    <label for="username" class="block text-sm font-medium text-gray-700 mb-2">아이디</label>
                    <input type="text" id="username" name="username" required 
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="mb-6">
                    <label for="password" class="block text-sm font-medium text-gray-700 mb-2">비밀번호</label>
                    <input type="password" id="password" name="password" required
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                <button type="submit" class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <span id="loginButtonText">로그인</span>
                    <div id="loginSpinner" class="loading-spinner" style="display: none;"></div>
                </button>
            </form>
        </div>
    </div>

    <!-- 관세신고 조회 모달 -->
    <div id="dutyModal" class="modal">
        <div class="duty-modal-content">
            <button class="close-button" onclick="closeModal('dutyModal')">&times;</button>
            <h2 class="text-3xl font-bold text-center mb-6 text-gray-800">관세성실신고 조회 시스템</h2>
            
            <!-- 사용자 정보 -->
            <div class="bg-blue-50 p-4 rounded-lg mb-6">
                <div class="flex justify-between items-center">
                    <div>
                        <span class="text-sm text-gray-600">로그인 사용자:</span>
                        <span id="currentUser" class="font-semibold text-gray-800 ml-2"></span>
                        <span class="text-sm text-gray-600 ml-4">화주명:</span>
                        <span id="currentCompany" class="font-semibold text-gray-800 ml-2"></span>
                    </div>
                    <button onclick="logout()" class="bg-red-500 text-white px-4 py-2 rounded-md hover:bg-red-600 text-sm">
                        로그아웃
                    </button>
                </div>
            </div>

            <!-- 마스터 전용 탭 -->
            <div id="masterTabs" class="tab-container" style="display: none;">
                <div class="tab-buttons">
                    <button class="tab-button active" onclick="switchTab('duty-management')">
                        <i class="fas fa-clipboard-list mr-2"></i>신고내역 관리
                    </button>
                    <button class="tab-button" onclick="switchTab('account-management')">
                        <i class="fas fa-users-cog mr-2"></i>계정 관리
                    </button>
                </div>
            </div>

            <!-- 신고내역 관리 탭 -->
            <div id="duty-management" class="tab-content active">
                <!-- 조회 필터 -->
                <div class="bg-gray-50 p-6 rounded-lg mb-6">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">조회 조건</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4">
                        <div class="autocomplete-container">
                            <label class="block text-sm font-medium text-gray-700 mb-1">화주명</label>
                            <input type="text" id="filterCompany" placeholder="화주명 입력" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                   oninput="handleAutocomplete(this, 'company')" onkeydown="handleKeydown(event, this)">
                            <div class="autocomplete-dropdown"></div>
                        </div>
                        <div class="autocomplete-container">
                            <label class="block text-sm font-medium text-gray-700 mb-1">해외거래처명</label>
                            <input type="text" id="filterSupplier" placeholder="거래처명 입력"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                   oninput="handleAutocomplete(this, 'supplier')" onkeydown="handleKeydown(event, this)">
                            <div class="autocomplete-dropdown"></div>
                        </div>
                        <div class="autocomplete-container">
                            <label class="block text-sm font-medium text-gray-700 mb-1">결제방법</label>
                            <input type="text" id="filterPayment" placeholder="결제방법 입력"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                   oninput="handleAutocomplete(this, 'payment')" onkeydown="handleKeydown(event, this)">
                            <div class="autocomplete-dropdown"></div>
                        </div>
                        <div class="autocomplete-container">
                            <label class="block text-sm font-medium text-gray-700 mb-1">거래구분</label>
                            <input type="text" id="filterTrade" placeholder="거래구분 입력"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                   oninput="handleAutocomplete(this, 'trade')" onkeydown="handleKeydown(event, this)">
                            <div class="autocomplete-dropdown"></div>
                        </div>
                        <div class="autocomplete-container">
                            <label class="block text-sm font-medium text-gray-700 mb-1">인도조건</label>
                            <input type="text" id="filterDelivery" placeholder="인도조건 입력"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                   oninput="handleAutocomplete(this, 'delivery')" onkeydown="handleKeydown(event, this)">
                            <div class="autocomplete-dropdown"></div>
                        </div>
                    </div>
                    <div class="mt-4">
                        <button onclick="clearFilters()" class="bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600 mr-2">
                            필터 초기화
                        </button>
                        <button onclick="applyFilters()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">
                            조회
                        </button>
                    </div>
                </div>

                <!-- 마스터 전용 데이터 추가 -->
                <div id="masterControls" style="display: none;">
                    <div class="bg-green-50 p-6 rounded-lg mb-6">
                        <h3 class="text-lg font-semibold mb-4 text-gray-800">새 신고내역 추가</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4">
                            <div class="autocomplete-container">
                                <label class="block text-sm font-medium text-gray-700 mb-1">화주명</label>
                                <input type="text" id="newCompany" placeholder="화주명"
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                                       oninput="handleAutocomplete(this, 'company')" onkeydown="handleKeydown(event, this)">
                                <div class="autocomplete-dropdown"></div>
                            </div>
                            <div class="autocomplete-container">
                                <label class="block text-sm font-medium text-gray-700 mb-1">해외거래처명</label>
                                <input type="text" id="newSupplier" placeholder="거래처명"
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                                       oninput="handleAutocomplete(this, 'supplier')" onkeydown="handleKeydown(event, this)">
                                <div class="autocomplete-dropdown"></div>
                            </div>
                            <div class="autocomplete-container">
                                <label class="block text-sm font-medium text-gray-700 mb-1">결제방법</label>
                                <input type="text" id="newPayment" placeholder="결제방법"
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                                       oninput="handleAutocomplete(this, 'payment')" onkeydown="handleKeydown(event, this)">
                                <div class="autocomplete-dropdown"></div>
                            </div>
                            <div class="autocomplete-container">
                                <label class="block text-sm font-medium text-gray-700 mb-1">거래구분</label>
                                <input type="text" id="newTrade" placeholder="거래구분"
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                                       oninput="handleAutocomplete(this, 'trade')" onkeydown="handleKeydown(event, this)">
                                <div class="autocomplete-dropdown"></div>
                            </div>
                            <div class="autocomplete-container">
                                <label class="block text-sm font-medium text-gray-700 mb-1">인도조건</label>
                                <input type="text" id="newDelivery" placeholder="인도조건"
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"
                                       oninput="handleAutocomplete(this, 'delivery')" onkeydown="handleKeydown(event, this)">
                                <div class="autocomplete-dropdown"></div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">신고번호</label>
                                <input type="text" id="newDeclaration" placeholder="신고번호"
                                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                            </div>
                        </div>
                        <div class="mt-4">
                            <button onclick="addNewDutyRecord()" class="bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700">
                                <i class="fas fa-plus mr-2"></i>신고내역 추가
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 조회 결과 -->
                <div class="bg-white rounded-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">조회 결과</h3>
                        <span id="resultCount" class="text-sm text-gray-600"></span>
                    </div>
                    <div class="overflow-x-auto" style="max-height: 600px; overflow-y: auto;">
                        <table class="results-table">
                            <thead>
                                <tr>
                                    <th>화주명</th>
                                    <th>해외거래처명</th>
                                    <th>결제방법</th>
                                    <th>거래구분</th>
                                    <th>인도조건</th>
                                    <th>신고번호</th>
                                    <th id="actionHeader" style="display: none;">관리</th>
                                </tr>
                            </thead>
                            <tbody id="dutyResultsBody">
                                <tr>
                                    <td colspan="7" class="text-center text-gray-500 py-8">
                                        <div class="loading-spinner mx-auto mb-2"></div>
                                        로딩 중...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- 계정 관리 탭 -->
            <div id="account-management" class="tab-content">
                <!-- 새 계정 추가 -->
                <div class="bg-purple-50 p-6 rounded-lg mb-6">
                    <h3 class="text-lg font-semibold mb-4 text-gray-800">새 계정 추가</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">아이디</label>
                            <input type="text" id="newAccountId" placeholder="아이디 입력"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">비밀번호</label>
                            <input type="password" id="newAccountPw" placeholder="비밀번호 입력"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500">
                        </div>
                        <div class="autocomplete-container">
                            <label class="block text-sm font-medium text-gray-700 mb-1">화주명</label>
                            <input type="text" id="newAccountCompany" placeholder="화주명 입력"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500"
                                   oninput="handleAutocomplete(this, 'company')" onkeydown="handleKeydown(event, this)">
                            <div class="autocomplete-dropdown"></div>
                        </div>
                    </div>
                    <div class="mt-4">
                        <button onclick="addNewAccount()" class="bg-purple-600 text-white px-6 py-2 rounded-md hover:bg-purple-700">
                            <i class="fas fa-user-plus mr-2"></i>계정 추가
                        </button>
                    </div>
                </div>

                <!-- 계정 목록 -->
                <div class="bg-white rounded-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">계정 목록</h3>
                        <button onclick="loadAccountData()" class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">
                            <i class="fas fa-refresh mr-2"></i>새로고침
                        </button>
                    </div>
                    <div class="overflow-x-auto" style="max-height: 500px; overflow-y: auto;">
                        <table class="results-table">
                            <thead>
                                <tr>
                                    <th>아이디</th>
                                    <th>비밀번호</th>
                                    <th>화주명</th>
                                    <th>관리</th>
                                </tr>
                            </thead>
                            <tbody id="accountResultsBody">
                                <tr>
                                    <td colspan="4" class="text-center text-gray-500 py-8">
                                        계정 정보를 불러오는 중...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 토스트 메시지 -->
    <div id="toast" class="toast"></div>

    <!-- JavaScript -->
    <script>
        // Google Apps Script API 엔드포인트
        const API_ENDPOINT = 'https://script.google.com/macros/s/AKfycbykEtTCbdsjk_7aj31gDT5UW8zolDphnasd7bNEzFL5zOEB-KblBJLCpgCIaL8_duwrDQ/exec';
        
        // 전역 변수
        let currentUserData = null;
        let allDutyData = [];
        let allAccountData = [];
        let filteredData = [];
        let autocompleteCache = {
            companies: [],
            suppliers: [],
            payments: [],
            trades: [],
            deliveries: []
        };
        let editingRowIndex = -1;
        let editingOriginalData = null;

        // 페이지 로드 시 초기화
        document.addEventListener('DOMContentLoaded', function() {
            handleScrollAnimation();
            smoothScroll();
            
            window.addEventListener('scroll', handleScrollAnimation);
        });

        // 스크롤 애니메이션
        function handleScrollAnimation() {
            const elements = document.querySelectorAll('.fade-in');
            elements.forEach(element => {
                const elementTop = element.getBoundingClientRect().top;
                const elementVisible = 150;
                
                if (elementTop < window.innerHeight - elementVisible) {
                    element.classList.add('visible');
                }
            });
        }

        // 스무스 스크롤
        function smoothScroll() {
            const links = document.querySelectorAll('nav a[href^="#"]');
            links.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        const offsetTop = targetElement.offsetTop - 90;
                        window.scrollTo({
                            top: offsetTop,
                            behavior: 'smooth'
                        });
                    }
                });
            });
        }

        // API 호출 헬퍼 함수
        async function callAPI(action, data = {}) {
            try {
                const formData = new FormData();
                formData.append('action', action);
                
                // 데이터 추가
                Object.keys(data).forEach(key => {
                    formData.append(key, data[key]);
                });
                
                const response = await fetch(API_ENDPOINT, {
                    method: 'POST',
                    body: formData
                });
                
                return await response.json();
            } catch (error) {
                console.error('API call error:', error);
                return { success: false, message: 'API 호출 중 오류가 발생했습니다.' };
            }
        }

        // 관세신고 조회 로그인 모달 표시
        function showDutyLogin() {
            document.getElementById('loginModal').style.display = 'flex';
        }

        // 모달 닫기 (X 버튼으로만)
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
            
            // 로그인 모달 닫을 때 폼 리셋
            if (modalId === 'loginModal') {
                document.getElementById('loginForm').reset();
            }
            
            // 관세신고 모달 닫을 때 상태 초기화
            if (modalId === 'dutyModal') {
                currentUserData = null;
                allDutyData = [];
                allAccountData = [];
                filteredData = [];
                editingRowIndex = -1;
                editingOriginalData = null;
            }
        }

        // 로그인 처리
        async function handleLogin(event) {
            event.preventDefault();
            
            const loginButton = document.querySelector('#loginForm button[type="submit"]');
            const loginText = document.getElementById('loginButtonText');
            const loginSpinner = document.getElementById('loginSpinner');
            
            // 로딩 상태 표시
            loginButton.disabled = true;
            loginText.style.display = 'none';
            loginSpinner.style.display = 'inline-block';
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            const result = await callAPI('login', { username, password });
            
            // 로딩 상태 해제
            loginButton.disabled = false;
            loginText.style.display = 'inline';
            loginSpinner.style.display = 'none';
            
            if (result.success) {
                currentUserData = result.user;
                closeModal('loginModal');
                showDutyModal();
            } else {
                showToast(result.message, 'error');
            }
        }

        // 관세신고 조회 모달 표시
        async function showDutyModal() {
            document.getElementById('currentUser').textContent = currentUserData.username;
            document.getElementById('currentCompany').textContent = currentUserData.company;
            
            // 권한에 따른 UI 설정
            if (currentUserData.isMaster) {
                document.getElementById('masterTabs').style.display = 'block';
                document.getElementById('masterControls').style.display = 'block';
                document.getElementById('actionHeader').style.display = 'table-cell';
            } else {
                document.getElementById('masterTabs').style.display = 'none';
                document.getElementById('masterControls').style.display = 'none';
                document.getElementById('actionHeader').style.display = 'none';
            }
            
            document.getElementById('dutyModal').style.display = 'flex';
            
            // 데이터 로드 (로딩 완료 후 표시)
            await loadDutyData();
            if (currentUserData.isMaster) {
                await loadAccountData();
            }
        }

        // 탭 전환
        function switchTab(tabName) {
            // 모든 탭 버튼과 내용 비활성화
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // 선택된 탭 활성화
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // 관세신고 데이터 로드
        async function loadDutyData() {
            const result = await callAPI('getDutyData', {
                isMaster: currentUserData.isMaster,
                company: currentUserData.company
            });
            
            if (result.success) {
                allDutyData = result.data;
                updateAutocompleteCache();
                filteredData = [...allDutyData];
                displayDutyResults();
                populateFilterOptions();
            } else {
                showToast(result.message, 'error');
                document.getElementById('dutyResultsBody').innerHTML = 
                    '<tr><td colspan="7" class="text-center text-red-500 py-8">데이터를 불러오는데 실패했습니다.</td></tr>';
            }
        }

        // 자동완성 캐시 업데이트
        function updateAutocompleteCache() {
            autocompleteCache.companies = [...new Set(allDutyData.map(row => row[0]).filter(Boolean))];
            autocompleteCache.suppliers = [...new Set(allDutyData.map(row => row[1]).filter(Boolean))];
            autocompleteCache.payments = [...new Set(allDutyData.map(row => row[2]).filter(Boolean))];
            autocompleteCache.trades = [...new Set(allDutyData.map(row => row[3]).filter(Boolean))];
            autocompleteCache.deliveries = [...new Set(allDutyData.map(row => row[4]).filter(Boolean))];
        }

        // 자동완성 처리
        const debounce = (func, delay) => {
            let timeoutId;
            return (...args) => {
                clearTimeout(timeoutId);
                timeoutId = setTimeout(() => func(...args), delay);
            };
        };

        const handleAutocomplete = debounce((input, type) => {
            const value = input.value.toLowerCase();
            if (value.length < 1) {
                hideAutocomplete(input);
                return;
            }

            let suggestions = [];
            switch(type) {
                case 'company':
                    suggestions = autocompleteCache.companies;
                    break;
                case 'supplier':
                    suggestions = autocompleteCache.suppliers;
                    break;
                case 'payment':
                    suggestions = autocompleteCache.payments;
                    break;
                case 'trade':
                    suggestions = autocompleteCache.trades;
                    break;
                case 'delivery':
                    suggestions = autocompleteCache.deliveries;
                    break;
            }

            suggestions = suggestions.filter(item => 
                item.toLowerCase().includes(value)
            ).slice(0, 10);

            showAutocomplete(input, suggestions, value);
        }, 300);

        // 자동완성 드롭다운 표시
        function showAutocomplete(input, suggestions, searchValue) {
            const dropdown = input.nextElementSibling;
            
            if (suggestions.length === 0) {
                hideAutocomplete(input);
                return;
            }

            dropdown.innerHTML = suggestions.map(suggestion => {
                const highlighted = suggestion.replace(
                    new RegExp(searchValue, 'gi'),
                    match => `<span class="highlight">${match}</span>`
                );
                return `<div class="autocomplete-item" onclick="selectAutocomplete('${input.id}', '${suggestion.replace(/'/g, "\\\'")}')">${highlighted}</div>`;
            }).join('');

            dropdown.style.display = 'block';
        }

        // 자동완성 숨기기
        function hideAutocomplete(input) {
            const dropdown = input.nextElementSibling;
            if (dropdown && dropdown.classList.contains('autocomplete-dropdown')) {
                dropdown.style.display = 'none';
            }
        }

        // 자동완성 선택
        function selectAutocomplete(inputId, value) {
            const input = document.getElementById(inputId);
            input.value = value;
            hideAutocomplete(input);
            
            // 필터 입력인 경우 자동 조회
            if (inputId.startsWith('filter')) {
                applyFilters();
            }
        }

        // 키보드 이벤트 처리
        function handleKeydown(event, input) {
            const dropdown = input.nextElementSibling;
            if (!dropdown || !dropdown.classList.contains('autocomplete-dropdown')) return;
            
            const items = dropdown.querySelectorAll('.autocomplete-item');
            
            if (items.length === 0) return;
            
            const currentSelected = dropdown.querySelector('.autocomplete-item.selected');
            let currentIndex = -1;
            
            if (currentSelected) {
                currentIndex = Array.from(items).indexOf(currentSelected);
            }
            
            switch(event.key) {
                case 'ArrowDown':
                    event.preventDefault();
                    const nextIndex = currentIndex < items.length - 1 ? currentIndex + 1 : 0;
                    selectItem(items, nextIndex);
                    break;
                case 'ArrowUp':
                    event.preventDefault();
                    const prevIndex = currentIndex > 0 ? currentIndex - 1 : items.length - 1;
                    selectItem(items, prevIndex);
                    break;
                case 'Enter':
                    event.preventDefault();
                    if (currentSelected) {
                        currentSelected.click();
                    }
                    break;
                case 'Escape':
                    hideAutocomplete(input);
                    break;
            }
        }

        // 항목 선택
        function selectItem(items, index) {
            items.forEach(item => item.classList.remove('selected'));
            if (items[index]) {
                items[index].classList.add('selected');
            }
        }

        // 계정 데이터 로드 (마스터 전용)
        async function loadAccountData() {
            if (!currentUserData.isMaster) return;
            
            const result = await callAPI('getAccountData', {
                isMaster: currentUserData.isMaster
            });
            
            if (result.success) {
                allAccountData = result.data;
                displayAccountResults();
            } else {
                showToast(result.message, 'error');
                document.getElementById('accountResultsBody').innerHTML = 
                    '<tr><td colspan="4" class="text-center text-red-500 py-8">계정 데이터를 불러오는데 실패했습니다.</td></tr>';
            }
        }

        // 조회 결과 표시
        function displayDutyResults() {
            const tbody = document.getElementById('dutyResultsBody');
            const resultCount = document.getElementById('resultCount');
            
            if (filteredData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="text-center text-gray-500 py-8">조회 결과가 없습니다.</td></tr>';
                resultCount.textContent = '';
                return;
            }
            
            resultCount.textContent = `총 ${filteredData.length}건`;
            
            tbody.innerHTML = filteredData.map((row, index) => `
                <tr id="row-${index}">
                    <td>${row[0] || ''}</td>
                    <td>${row[1] || ''}</td>
                    <td>${row[2] || ''}</td>
                    <td>${row[3] || ''}</td>
                    <td>${row[4] || ''}</td>
                    <td class="copyable-cell" onclick="copyToClipboard('${row[5] || ''}')">
                        <i class="fas fa-copy mr-1"></i>${row[5] || ''}
                    </td>
                    ${currentUserData.isMaster ? `
                        <td>
                            <button class="edit-button" onclick="editRow(${index})">
                                <i class="fas fa-edit"></i> 편집
                            </button>
                            <button class="delete-button" onclick="deleteRow(${index})">
                                <i class="fas fa-trash"></i> 삭제
                            </button>
                        </td>
                    ` : ''}
                </tr>
            `).join('');
        }

        // 계정 결과 표시 (마스터 전용)
        function displayAccountResults() {
            const tbody = document.getElementById('accountResultsBody');
            
            if (allAccountData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" class="text-center text-gray-500 py-8">계정이 없습니다.</td></tr>';
                return;
            }
            
            tbody.innerHTML = allAccountData.map((row, index) => `
                <tr id="account-row-${index}">
                    <td>${row[0] || ''}</td>
                    <td>
                        <span class="password-hidden">••••••••</span>
                        <button onclick="togglePassword(${index})" class="ml-2 text-blue-600 hover:text-blue-800">
                            <i class="fas fa-eye"></i>
                        </button>
                    </td>
                    <td>${row[2] || ''}</td>
                    <td>
                        <button class="edit-button" onclick="editAccount(${index})" ${row[0] === 'aincustoms' ? 'disabled style="opacity: 0.5;"' : ''}>
                            <i class="fas fa-edit"></i> 편집
                        </button>
                        <button class="delete-button" onclick="deleteAccount(${index})" ${row[0] === 'aincustoms' ? 'disabled style="opacity: 0.5;"' : ''}>
                            <i class="fas fa-trash"></i> 삭제
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // 필터 옵션 채우기
        function populateFilterOptions() {
            // 필터링을 위한 자동완성이 이미 적용되어 있으므로 추가 작업 불필요
        }

        // 필터 적용
        function applyFilters() {
            const company = document.getElementById('filterCompany').value.toLowerCase();
            const supplier = document.getElementById('filterSupplier').value.toLowerCase();
            const payment = document.getElementById('filterPayment').value.toLowerCase();
            const trade = document.getElementById('filterTrade').value.toLowerCase();
            const delivery = document.getElementById('filterDelivery').value.toLowerCase();
            
            filteredData = allDutyData.filter(row => {
                return (
                    (!company || (row[0] && row[0].toLowerCase().includes(company))) &&
                    (!supplier || (row[1] && row[1].toLowerCase().includes(supplier))) &&
                    (!payment || (row[2] && row[2].toLowerCase().includes(payment))) &&
                    (!trade || (row[3] && row[3].toLowerCase().includes(trade))) &&
                    (!delivery || (row[4] && row[4].toLowerCase().includes(delivery)))
                );
            });
            
            displayDutyResults();
        }

        // 필터 초기화
        function clearFilters() {
            document.getElementById('filterCompany').value = '';
            document.getElementById('filterSupplier').value = '';
            document.getElementById('filterPayment').value = '';
            document.getElementById('filterTrade').value = '';
            document.getElementById('filterDelivery').value = '';
            
            filteredData = [...allDutyData];
            displayDutyResults();
        }

        // 신규 신고내역 추가 (마스터 전용)
        async function addNewDutyRecord() {
            if (!currentUserData.isMaster) return;
            
            const company = document.getElementById('newCompany').value.trim();
            const supplier = document.getElementById('newSupplier').value.trim();
            const payment = document.getElementById('newPayment').value.trim();
            const trade = document.getElementById('newTrade').value.trim();
            const delivery = document.getElementById('newDelivery').value.trim();
            const declaration = document.getElementById('newDeclaration').value.trim();
            
            if (!company || !supplier || !payment || !trade || !delivery || !declaration) {
                showToast('모든 필드를 입력해주세요.', 'error');
                return;
            }
            
            const result = await callAPI('addDutyRecord', {
                isMaster: currentUserData.isMaster,
                company, supplier, payment, trade, delivery, declaration
            });
            
            if (result.success) {
                showToast(result.message, 'success');
                
                // 입력 필드 초기화
                document.getElementById('newCompany').value = '';
                document.getElementById('newSupplier').value = '';
                document.getElementById('newPayment').value = '';
                document.getElementById('newTrade').value = '';
                document.getElementById('newDelivery').value = '';
                document.getElementById('newDeclaration').value = '';
                
                // 데이터 재로드
                await loadDutyData();
            } else {
                showToast(result.message, 'error');
            }
        }

        // 신규 계정 추가 (마스터 전용)
        async function addNewAccount() {
            if (!currentUserData.isMaster) return;
            
            const id = document.getElementById('newAccountId').value.trim();
            const password = document.getElementById('newAccountPw').value.trim();
            const company = document.getElementById('newAccountCompany').value.trim();
            
            if (!id || !password || !company) {
                showToast('모든 필드를 입력해주세요.', 'error');
                return;
            }
            
            const result = await callAPI('addAccount', {
                isMaster: currentUserData.isMaster,
                id, password, company
            });
            
            if (result.success) {
                showToast(result.message, 'success');
                
                // 입력 필드 초기화
                document.getElementById('newAccountId').value = '';
                document.getElementById('newAccountPw').value = '';
                document.getElementById('newAccountCompany').value = '';
                
                // 데이터 재로드
                await loadAccountData();
            } else {
                showToast(result.message, 'error');
            }
        }

        // 행 편집 (마스터 전용)
        function editRow(index) {
            if (!currentUserData.isMaster || editingRowIndex !== -1) return;
            
            editingRowIndex = index;
            editingOriginalData = [...filteredData[index]];
            
            const row = document.getElementById(`row-${index}`);
            const cells = row.cells;
            
            // 모든 필드를 편집 가능하게 변경 (신고번호 포함)
            for (let i = 0; i < 6; i++) {
                const originalValue = editingOriginalData[i] || '';
                cells[i].classList.add('editing-cell');
                cells[i].innerHTML = `<input type="text" value="${originalValue}" class="editing-input" id="edit-${index}-${i}">`;
            }
            
            // 관리 버튼을 저장/취소로 변경
            if (cells[6]) {
                cells[6].innerHTML = `
                    <button class="save-button" onclick="saveRow(${index})">
                        <i class="fas fa-save"></i> 저장
                    </button>
                    <button class="cancel-button" onclick="cancelEdit(${index})">
                        <i class="fas fa-times"></i> 취소
                    </button>
                `;
            }
        }

        // 편집 저장 (마스터 전용)
        async function saveRow(index) {
            if (!currentUserData.isMaster || editingRowIndex !== index) return;
            
            const newData = [];
            for (let i = 0; i < 6; i++) {
                const input = document.getElementById(`edit-${index}-${i}`);
                newData[i] = input ? input.value.trim() : '';
            }
            
            const result = await callAPI('updateDutyRecord', {
                isMaster: currentUserData.isMaster,
                rowIndex: index,
                company: newData[0],
                supplier: newData[1],
                payment: newData[2],
                trade: newData[3],
                delivery: newData[4],
                declaration: newData[5]
            });
            
            if (result.success) {
                // 로컬 데이터 업데이트
                filteredData[index] = newData;
                const originalIndex = allDutyData.findIndex(row => 
                    JSON.stringify(row) === JSON.stringify(editingOriginalData)
                );
                if (originalIndex !== -1) {
                    allDutyData[originalIndex] = newData;
                }
                
                editingRowIndex = -1;
                editingOriginalData = null;
                
                showToast(result.message, 'success');
                displayDutyResults();
                updateAutocompleteCache();
            } else {
                showToast(result.message, 'error');
            }
        }

        // 편집 취소
        function cancelEdit(index) {
            if (editingRowIndex !== index) return;
            
            editingRowIndex = -1;
            editingOriginalData = null;
            displayDutyResults();
        }

        // 행 삭제 (마스터 전용)
        async function deleteRow(index) {
            if (!currentUserData.isMaster) return;
            
            if (!confirm('정말로 이 데이터를 삭제하시겠습니까?')) return;
            
            const result = await callAPI('deleteDutyRecord', {
                isMaster: currentUserData.isMaster,
                rowIndex: index
            });
            
            if (result.success) {
                showToast(result.message, 'success');
                await loadDutyData(); // 전체 데이터 재로드
            } else {
                showToast(result.message, 'error');
            }
        }

        // 계정 편집 (마스터 전용)
        function editAccount(index) {
            if (!currentUserData.isMaster || allAccountData[index][0] === 'aincustoms') return;
            
            // 계정 편집 구현 (생략 - 필요시 추가)
            showToast('계정 편집 기능은 추후 구현 예정입니다.', 'error');
        }

        // 계정 삭제 (마스터 전용)
        async function deleteAccount(index) {
            if (!currentUserData.isMaster || allAccountData[index][0] === 'aincustoms') return;
            
            if (!confirm('정말로 이 계정을 삭제하시겠습니까?')) return;
            
            const result = await callAPI('deleteAccount', {
                isMaster: currentUserData.isMaster,
                rowIndex: index,
                id: allAccountData[index][0]
            });
            
            if (result.success) {
                showToast(result.message, 'success');
                await loadAccountData();
            } else {
                showToast(result.message, 'error');
            }
        }

        // 비밀번호 표시/숨김 토글
        function togglePassword(index) {
            const row = document.getElementById(`account-row-${index}`);
            const passwordCell = row.cells[1];
            const isHidden = passwordCell.innerHTML.includes('••••••••');
            
            if (isHidden) {
                passwordCell.innerHTML = `
                    <span>${allAccountData[index][1]}</span>
                    <button onclick="togglePassword(${index})" class="ml-2 text-blue-600 hover:text-blue-800">
                        <i class="fas fa-eye-slash"></i>
                    </button>
                `;
            } else {
                passwordCell.innerHTML = `
                    <span class="password-hidden">••••••••</span>
                    <button onclick="togglePassword(${index})" class="ml-2 text-blue-600 hover:text-blue-800">
                        <i class="fas fa-eye"></i>
                    </button>
                `;
            }
        }

        // 클립보드에 복사
        function copyToClipboard(text) {
            if (!text) return;
            
            navigator.clipboard.writeText(text).then(() => {
                showToast(`신고번호 "${text}"가 복사되었습니다!`, 'success');
            }).catch(err => {
                console.error('Copy failed:', err);
                
                // 폴백 방식
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    showToast(`신고번호 "${text}"가 복사되었습니다!`, 'success');
                } catch (fallbackErr) {
                    showToast('복사에 실패했습니다.', 'error');
                }
                document.body.removeChild(textArea);
            });
        }

        // 토스트 메시지 표시
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type === 'error' ? 'error' : ''}`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // 로그아웃
        function logout() {
            currentUserData = null;
            closeModal('dutyModal');
            
            // 폼 초기화
            document.getElementById('loginForm').reset();
            
            showToast('로그아웃되었습니다.', 'success');
        }

        // 모달 외부 클릭 방지 - 제거됨 (X 버튼으로만 닫기)
        // 자동완성 드롭다운은 여전히 바깥 클릭으로 닫힘
        document.addEventListener('click', function(event) {
            // 자동완성 드롭다운 숨기기
            const dropdowns = document.querySelectorAll('.autocomplete-dropdown');
            dropdowns.forEach(dropdown => {
                if (!dropdown.contains(event.target) && !dropdown.previousElementSibling.contains(event.target)) {
                    dropdown.style.display = 'none';
                }
            });
        });
    </script>
</body>
</html>
